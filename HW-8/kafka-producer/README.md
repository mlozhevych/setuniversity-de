# Kafka Tweet Producer

–¶–µ–π –ø—Ä–æ—î–∫—Ç —î –ø—Ä–æ–¥—é—Å–µ—Ä–æ–º Kafka, —è–∫–∏–π —Å–∏–º—É–ª—é—î –ø–æ—Ç—ñ–∫ —Ç–≤—ñ—Ç—ñ–≤. –í—ñ–Ω —á–∏—Ç–∞—î –¥–∞–Ω—ñ –∑ CSV-—Ñ–∞–π–ª—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å –¥–∞–Ω—ñ —Å–ª—É–∂–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏
Twitter, —ñ –Ω–∞–¥—Å–∏–ª–∞—î —ó—Ö —è–∫ –æ–∫—Ä–µ–º—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —Ç–æ–ø—ñ–∫ Kafka "tweets".

--- 

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **–ú–æ–≤–∞**: Python 3.9+

- **–ö–µ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏:** Poetry

- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è:** Docker, Docker Compose

## –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

1. –°–∫–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:

  ```bash
    git clone https://github.com/mlozhevych/setuniversity-de.git
    cd HW-8/kafka-producer
  ```

2. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` —É –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É (`kafka-producer/`).
3. –ó–∞–ø—É—Å–∫.

   –©–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ Kafka, Zookeeper —Ç–∞ –ø—Ä–æ–¥—é—Å–µ—Ä —Ç–≤—ñ—Ç—ñ–≤, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ—Ä–µ–Ω–µ–≤—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –ø—Ä–æ—î–∫—Ç—É:
   ```bash
   docker-compose up --build
   ```

   –¶—è –∫–æ–º–∞–Ω–¥–∞ –≤–∏–∫–æ–Ω–∞—î –Ω–∞—Å—Ç—É–ø–Ω—ñ –¥—ñ—ó:

    - –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –æ–±—Ä–∞–∑–∏ –¥–ª—è Kafka —Ç–∞ Zookeeper.

    - –ó–±—É–¥—É—î Docker-–æ–±—Ä–∞–∑ –¥–ª—è –ø—Ä–æ–¥—é—Å–µ—Ä–∞ —Ç–≤—ñ—Ç—ñ–≤ (tweet-producer) –∑–≥—ñ–¥–Ω–æ –∑ Dockerfile.

    - –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—ñ —Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –≤ –æ–¥–Ω—ñ–π –º–µ—Ä–µ–∂—ñ.

    - –ü—ñ–¥ —á–∞—Å –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–¥—é—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç –∑ Kaggle.

4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏:

    - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤:

      –í—ñ–¥–∫—Ä–∏–π—Ç–µ –Ω–æ–≤–∏–π —Ç–µ—Ä–º—ñ–Ω–∞–ª —ñ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:
      ```bash
      docker ps
      ```

      –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏ —Ç—Ä–∏ –∑–∞–ø—É—â–µ–Ω–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏: `kafka`, `zookeeper` —Ç–∞ `tweet-producer`:

      ![docker-ps.png](docs/docker-ps.png)
      ![docker-components.png](docs/docker-components.png)

    - –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤ –ø—Ä–æ–¥—é—Å–µ—Ä–∞:
      –©–æ–± –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –ø—Ä–æ–¥—é—Å–µ—Ä –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –π–æ–≥–æ –ª–æ–≥–∏:
      ```bash
      docker logs -f tweet-producer
      ```
      –í–∏ –ø–æ–±–∞—á–∏—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Kafka —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏—Ö —Ç–≤—ñ—Ç—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
      ```
      Successfully connected to Kafka broker.
      Starting to stream data from 'src/kafka_producer/data/twcs/twcs.csv' to topic 'tweets'...
      Sent: 1
      Sent: 2
      ...
      ```
    - –ß–∏—Ç–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ —Ç–æ–ø—ñ–∫—É Kafka:
      –©–æ–± –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ —Ç–æ–ø—ñ–∫—É tweets, –≤–∏–∫–æ–Ω–∞–π—Ç–µ —Ç–∞–∫—É –∫–æ–º–∞–Ω–¥—É:
      ```bash
      docker-compose exec kafka kafka-console-consumer --bootstrap-server localhost:9092 --topic tweets --from-beginning
      ```
      –í–∏ –ø–æ–±–∞—á–∏—Ç–µ –ø–æ—Ç—ñ–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON, —è–∫—ñ –Ω–∞–¥—Å–∏–ª–∞—î –≤–∞—à –ø—Ä–æ–¥—é—Å–µ—Ä:
      ![kafka-console-consumer.png](docs/kafka-console-consumer.png)

## –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É

–£ –ø—Ä–æ—î–∫—Ç—ñ —î —Å–∫—Ä–∏–ø—Ç `restart-kafka.sh`, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —à–≤–∏–¥–∫–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ Kafka —Ç–∞ –æ—á–∏—Å—Ç–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ.

```bash
  ./restart-kafka.sh
```

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –∑—É–ø–∏–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, –≤–∏–¥–∞–ª–∏—Ç—å –¥–∞–Ω—ñ Kafka —ñ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∑–Ω–æ–≤—É —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
kafka-producer/
‚îú‚îÄ‚îÄ data/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ kafka_producer/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ producer.py
‚îÇ       ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ pyproject.toml
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ restart-kafka.sh
```