# REST API –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –∫–∞–º–ø–∞–Ω—ñ–π

–¶–µ–π –ø—Ä–æ—î–∫—Ç —î RESTful API, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–º –Ω–∞ Flask, –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –∫–∞–º–ø–∞–Ω—ñ–π, –≤–∏—Ç—Ä–∞—Ç —Ä–µ–∫–ª–∞–º–æ–¥–∞–≤—Ü—ñ–≤ —Ç–∞
–∑–∞–ª—É—á–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–µ—à—É–≤–∞–Ω–Ω—è Redis –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- **–ê–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–∞–º–ø–∞–Ω—ñ—ó:** –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –∫–∞–º–ø–∞–Ω—ñ—ó, –≤–∫–ª—é—á–∞—é—á–∏ CTR, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª—ñ–∫—ñ–≤,
  –ø–æ–∫–∞–∑—ñ–≤ —Ç–∞ –∑–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏.

- **–í–∏—Ç—Ä–∞—Ç–∏ —Ä–µ–∫–ª–∞–º–æ–¥–∞–≤—Ü—è:** –ü–µ—Ä–µ–≥–ª—è–¥ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º—É –¥–ª—è –ø–µ–≤–Ω–æ–≥–æ —Ä–µ–∫–ª–∞–º–æ–¥–∞–≤—Ü—è –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–π –º—ñ—Å—è—Ü—å.

- **–ó–∞–ª—É—á–µ–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:** –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –≤–∑–∞—î–º–æ–¥—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ä–µ–∫–ª–∞–º–æ—é (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª—ñ–∫—ñ–≤ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–∏–π
  –¥–æ—Ö—ñ–¥).

- **–ö–µ—à—É–≤–∞–Ω–Ω—è –∑ Redis:** –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ read-through –∫–µ—à –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∑–∞–ø–∏—Ç–∏ —â–æ–¥–æ –∫–∞–º–ø–∞–Ω—ñ–π —Ç–∞
  —Ä–µ–∫–ª–∞–º–æ–¥–∞–≤—Ü—ñ–≤.

- **Swagger UI:** –Ü–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API —á–µ—Ä–µ–∑ Swagger –¥–ª—è –ª–µ–≥–∫–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Backend:** Python, Flask, Flask-Smorest, Gunicorn

- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö:** MySQL (–≤–∑–∞—î–º–æ–¥—ñ—è —á–µ—Ä–µ–∑ Flask-SQLAlchemy —Ç–∞ PyMySQL)

- **–ö–µ—à—É–≤–∞–Ω–Ω—è:** Redis

- **–ö–µ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏:** Poetry

- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è:** Docker, Docker Compose

- **–°–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è/–í–∞–ª—ñ–¥–∞—Ü—ñ—è:** Marshmallow

---

## üìã –í–∏–º–æ–≥–∏

- Docker —Ç–∞ Docker Compose

- Python 3.9+ (–¥–ª—è –∑–∞–ø—É—Å–∫—É –±–µ–Ω—á–º–∞—Ä–∫-—Å–∫—Ä–∏–ø—Ç—ñ–≤)

- Poetry

---

## ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

–ü—Ä–æ—î–∫—Ç –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –∑–∞–ø—É—Å–∫—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Docker, —â–æ —î —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º.

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ!)

1. **–ö–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:**
   ```bash
   git clone https://github.com/mlozhevych/setuniversity-de.git
   cd HW-5/analyze-ads-rest-api
   ```
2. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:**

   –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` —É –∫–æ—Ä–µ–Ω–µ–≤—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `analyze-ads-rest-api` —Ç–∞ –¥–æ–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
   `docker-compose.yml`
   –≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `host.docker.internal` –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –≤–∞—à–æ—ó –ª–æ–∫–∞–ª—å–Ω–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

   ```env
   DATABASE_HOST=host.docker.internal
   DATABASE_USER=adtech
   DATABASE_PASSWORD=adtechpass
   DATABASE_DB=AdTech
   ```
3. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Docker Compose:**

   –¶—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å API —Å–µ—Ä–≤—ñ—Å —Ç–∞ Redis.

   ```bash
   docker-compose up --build
   ```

   API –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é http://localhost:5002.


4. **–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó Swagger UI:**

   –í—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ `http://localhost:5002/swagger-ui` –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∞–º–∏.

   ![swagger.png](docs/swagger.png)

### –õ–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏!)

1. **–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø—Ä–æ—î–∫—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Poetry:**

   ```bash
    poetry install
    ```
2. **–ê–∫—Ç–∏–≤—É–π—Ç–µ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ, —Å—Ç–≤–æ—Ä–µ–Ω–µ Poetry:**

   ```bash
    poetry shell
    ```

3. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫:**

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ñ —É –≤–∞—à—ñ–π —Å–µ—Å—ñ—ó.

   ```bash
    poetry run python -m analyze_ads_rest_api.app
   ``` 

---

## üåê Endpoints API

–í—Å—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑–∞ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º /adtech.

| –ú–µ—Ç–æ–¥ | URL                                    | –û–ø–∏—Å                                                                                         |
|-------|----------------------------------------|----------------------------------------------------------------------------------------------|
| GET   | `/campaign/{campaign_id}/performance`  | –û—Ç—Ä–∏–º—É—î CTR, –∫–ª—ñ–∫–∏, –ø–æ–∫–∞–∑–∏ —Ç–∞ –≤–∏—Ç—Ä–∞—Ç–∏ –¥–ª—è –∫–∞–º–ø–∞–Ω—ñ—ó. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∫–µ—à—É—é—Ç—å—Å—è –Ω–∞ 30 —Å–µ–∫—É–Ω–¥.       |
| GET   | `/advertiser/{advertiser_id}/spending` | –ü–æ–≤–µ—Ä—Ç–∞—î –∑–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏ —Ä–µ–∫–ª–∞–º–æ–¥–∞–≤—Ü—è –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 30 –¥–Ω—ñ–≤. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∫–µ—à—É—é—Ç—å—Å—è –Ω–∞ 5 —Ö–≤–∏–ª–∏–Ω. |
| GET   | `/user/{user_id}/engagements`          | –ü–æ–≤–µ—Ä—Ç–∞—î –¥–∞–Ω—ñ –ø—Ä–æ –∑–∞–ª—É—á–µ–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–∫–ª—ñ–∫–∏ —Ç–∞ –¥–æ—Ö—ñ–¥). –¶–µ–π –µ–Ω–¥–ø–æ—ñ–Ω—Ç –Ω–µ –∫–µ—à—É—î—Ç—å—Å—è.       |

### –ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

–ó–∞–ø–∏—Ç —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–∞–º–ø–∞–Ω—ñ—ó:
![campaign.png](docs/campaign.png)

---

## üìä –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

–ü—Ä–æ—î–∫—Ç –º—ñ—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤.

1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ API –∑–∞–ø—É—â–µ–Ω–æ (—á–µ—Ä–µ–∑ Docker –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–æ).
2. –Ø–∫—â–æ –≤–∏ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞–ª–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ `poetry install`, —Ç–æ –∑—Ä–æ–±—ñ—Ç—å —Ü–µ :) .
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –±–µ–Ω—á–º–∞—Ä–∫-—Å–∫—Ä–∏–ø—Ç:

   ```bash
   poetry run runbenchmark
   ```

   –¶–µ–π —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω–∞—î 10 –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –∫–æ–∂–Ω–æ–≥–æ –µ–Ω–¥–ø–æ—ñ–Ω—Ç—É —Ç–∞ –≤–∏–≤–µ–¥–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

| Endpoint                                                     | No Cache (ms) | Redis Cache (ms) | Œî‚ÄëImprovement |
|--------------------------------------------------------------|---------------|------------------|---------------|
| `/campaign/705d4849-4c24-11f0-9f71-0242ac120002/performance` | 1849.54       | 12.49            | 148.1x        |
| `/advertiser/3/spending`                                     | 5293.91       | 12.16            | 435.2x        |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
.
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ pyproject.toml              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π Poetry
‚îú‚îÄ‚îÄ poetry.lock
‚îî‚îÄ‚îÄ src
    ‚îî‚îÄ‚îÄ analyze_ads_rest_api
        ‚îú‚îÄ‚îÄ __init__.py
        ‚îú‚îÄ‚îÄ app.py                  # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª Flask –¥–æ–¥–∞—Ç–∫—É
        ‚îú‚îÄ‚îÄ benchmark.py            # –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
        ‚îú‚îÄ‚îÄ cache.py                # –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∫–µ—à–µ–º Redis
        ‚îú‚îÄ‚îÄ db.py                   # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è SQLAlchemy
        ‚îú‚îÄ‚îÄ models                  # –ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö SQLAlchemy
        ‚îú‚îÄ‚îÄ queries                 # SQL –∑–∞–ø–∏—Ç–∏ –¥–ª—è –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏
        ‚îú‚îÄ‚îÄ resources               # –†–µ—Å—É—Ä—Å–∏ (–µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏) Flask-Smorest
        ‚îî‚îÄ‚îÄ schemas.py              # –°—Ö–µ–º–∏ Marshmallow –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
```